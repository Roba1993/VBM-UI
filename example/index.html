<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>VBM</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: rgb(255, 255, 255);
            width: 100%;
            height: 100%;
        }

        #container {
            position: absolute;
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="container"></div>
    <script src="./../dist/main.js"></script>
    <script>
        var logic = {
            rules: {
                strictInputOutput: true,    // Only allows to link inputs and outputs
                strictDifferentBlock: true, // Deny any link to the own block
                strictConnections: true     // Only allows to link matching types
            },
            style: {
                // Block Header style definition
                blockHeaderMargin: 5,
                blockHeaderTextSize: 20,
                blockHeaderTextColor: '#FFFFFF',
                blockHeaderStartColor: '#7777f7DD',
                blockHeaderEndColor: '#7777f7DD',

                // Block style definition
                blockCornerRadius: 10,
                blockStartColor: '#000000DD',
                blockEndColor: '#000000DD',
                blockBorderColor: 'orange',
                blockNodeSpacing: 10,
                blockNodeTextSize: 16,
                blockNodeValueBackground: 'white',

                // Creation Dialog style definition
                creationWidth: 250,
                creationHeight: 350,
                creationColor: '#7777f7DD',
                creationTextSize: 16,
                creationTextSpacing: 4,
                creationCornerRadius: 10,
                creationFilterTextSize: 20,
            },
            connections: [
                { type: 'Execution', color: 'black' },
                { type: 'String', color: 'purple', valueEdit: true, valueDefault: 'Text', },
                { type: 'Integer', color: 'green', valueEdit: true, valueDefault: '0', valueCheck: (text) => { return text.replace(/[^\d]/g, ''); } },
                { type: 'Float', color: 'green', valueEdit: true, valueDefault: '0', valueCheck: (text) => { return text.replace(/[^(\d+\.?\d+)]/g, ''); } },
            ],
            blocks: [
                {
                    id: 1,
                    name: 'Start',
                    nameEdit: false,
                    description: 'Startpoint for the logic',
                    inputs: [],
                    outputs: [{ name: 'Next', description: 'Connection to the next Execution block', type: 'Execution' }],
                    nodes: [{ id: 1, io: 'output', name: 'Next', description: 'Connection to the next Execution block', type: 'Execution' }],
                },
                {
                    id: 2,
                    name: 'Console Log',
                    nameEdit: false,
                    description: 'Standard printf/log output to the terminal',
                    inputs: [
                        { name: 'Run', description: 'Connection to the next Execution block', type: 'Execution' },
                        { name: 'Text', description: 'The text to log', type: 'String' }],
                    outputs: [{ name: 'Next', description: 'Connection to the next Execution block', type: 'Execution' }],
                    nodes: [
                        { id: 1, io: 'input', name: 'Run', description: 'Connection to the next Execution block', type: 'Execution' },
                        { id: 2, io: 'output', name: 'Next', description: 'Connection to the next Execution block', type: 'Execution' },
                        { id: 3, io: 'input', name: 'Text', description: 'The text to log', type: 'String' }
                    ]
                },
                {
                    id: 3,
                    name: 'Static Text',
                    nameEdit: false,
                    description: 'Definition of a static text',
                    nodes: [
                        { id: 1, io: 'input', name: '', nameEdit: false, description: 'The defined static text', type: 'String' },
                        { id: 2, io: 'output', name: '', nameEdit: false, description: 'The defined static text', type: 'String' }
                    ]
                },
            ]
        };


        var vbm = new VBM('container', logic);
        vbm.addBlock(1, 50, 50);

        vbm.setBusinesModel(JSON.parse(`
        [{"blockId":10,"blockTypeId":2,"position":{"x":1108,"y":352},"nodes":[{"id":1,"nodeType":"input","connectionType":"Execution","value":null,"connectedBlockId":9,"connectedBlockTypeId":1,"connectedNodeId":1},{"id":2,"nodeType":"output","connectionType":"Execution","value":null,"connectedBlockId":null,"connectedBlockTypeId":null,"connectedNodeId":null},{"id":3,"nodeType":"input","connectionType":"String","value":null,"connectedBlockId":11,"connectedBlockTypeId":3,"connectedNodeId":2}]},{"blockId":9,"blockTypeId":1,"position":{"x":796,"y":353},"nodes":[{"id":1,"nodeType":"output","connectionType":"Execution","value":null,"connectedBlockId":10,"connectedBlockTypeId":2,"connectedNodeId":1}]},{"blockId":11,"blockTypeId":3,"position":{"x":812,"y":492},"nodes":[{"id":1,"nodeType":"input","connectionType":"String","value":"Hello World","connectedBlockId":null,"connectedBlockTypeId":null,"connectedNodeId":null},{"id":2,"nodeType":"output","connectionType":"String","value":null,"connectedBlockId":10,"connectedBlockTypeId":2,"connectedNodeId":3}]}]
        `));
    </script>
</body>

</html>